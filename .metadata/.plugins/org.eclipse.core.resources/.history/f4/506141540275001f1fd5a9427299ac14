						<th>Action</th>
					</tr>
				</thead>
				<tbody>
					<c:forEach var="order" items="${orders}">
						<tr>
							<td><a href="#" class="order-link"
								data-order-id="${order.order_id}">${order.order_id}</a></td>
							<td>${order.grocery.groceryName}</td>
							<td>${order.users.user_Name}</td>
							<td>${order.totalAmount}</td>
							<td>${order.orderStatus}</td>
							<td>${order.order_date}</td>
							<td>
								<form
									action="${pageContext.request.contextPath}/orders/updateStatus"
									method="post" class="form-inline">
									<input type="hidden" name="order_id" value="${order.order_id}">
									<select name="orderStatus" class="form-control mr-2">
										<c:choose>
											<c:when test="${sessionScope.userRole eq 'Seller'}">
												<option value="Pending"
													${order.orderStatus == 'Pending' ? 'selected' : ''}>Pending</option>
												<option value="Processed"
													${order.orderStatus == 'Processed' ? 'selected' : ''}>Processed</option>
												<option value="Shipped"
													${order.orderStatus == 'Shipped' ? 'selected' : ''}>Shipped</option>
												<option value="Delivered"
													${order.orderStatus == 'Delivered' ? 'selected' : ''}>Delivered</option>
											</c:when>
											<c:otherwise>
												<option value="Cancelled"
													${order.orderStatus == 'Cancelled' ? 'selected' : ''}>Cancelled</option>
											</c:otherwise>
										</c:choose>
									</select>
									<button type="submit" class="btn btn-icon btn-sm">
										<i class="fas fa-edit"></i>
										<!-- Font Awesome Edit Icon -->
									</button>
								</form>
							</td>
						</tr>
					</c:forEach>
				</tbody>
			</table>
		</c:if>
		<c:if test="${empty orders}">
			<p>No orders found.</p>
		</c:if>
	</div>

	<!-- Modal -->
	<div class="modal fade" id="invoiceModal" tabindex="-1"
		aria-labelledby="invoiceModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="invoiceModalLabel">Invoice Details</h5>
					<button type="button" class="close" data-dismiss="modal"
						aria-label="Close">
						<span aria-hidden="true">×</span>
					</button>
				</div>
				<div class="modal-body">
					<!-- Invoice details will be loaded here -->
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary"
						data-dismiss="modal">Close</button>
				</div>
			</div>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<br>
	<br>
	<br>
	<br>
	<jsp:include page="/footer.jsp"></jsp:include>

	<c:if test="${updateSuccess}">
		<script>
			alert('Order status updated successfully');
		</script>
	</c:if>

	<script>
		$(document).ready(function() {
			$('.order-link').on('click', function(e) {
				e.preventDefault();
				var orderId = $(this).data('order-id');
				$.ajax({
					url : '${pageContext.request.contextPath}/orders/invoice',
					type : 'GET',
					data : {
						orderId : orderId
					},
					success : function(data) {
						$('#invoiceModal .modal-body').html(data);
						$('#invoiceModal').modal('show');
					}
				});
			});
		});

		function filterOrders() {
			var itemName = $('#itemName').val().toLowerCase();
			var userName = $('#userName').val().toLowerCase();
			var date = $('#date').val();
			var status = $('#status').val();

			$('#orderTable tbody tr').each(function() {
				var row = $(this);
				var itemNameCell = row.find('td').eq(1).text().toLowerCase();
				var userNameCell = row.find('td').eq(2).text().toLowerCase();
				var dateCell = row.find('td').eq(5).text();
				var statusCell = row.find('td').eq(4).text();

				var showRow = true;

				if (itemName && !itemNameCell.includes(itemName)) {
					showRow = false;
				}
				if (userName && !userNameCell.includes(userName)) {
					showRow = false;
				}
				if (date && date !== dateCell) {
					showRow = false;
				}
				if (status && status !== statusCell) {
					showRow = false;
				}

				row.toggle(showRow);
			});
		}
	</script>
</body>
</html>
